# JITCodeRunner
A program that allows you to execute machine code at runtime, allowing a convenient way to test and observe interactions and effects of Opcodes.

**************************************************************
@Author Cameron Grande
The following executes given byte sequences directly 
by the processor. This can be used for either learning
or testing. Upon running you will be prompted to enter a series
or bytes (instructions). To start, you can use combinations of 
the following to see how the machine responds. IE, you could 
use a series of NOPS (90) followed by a RET (C3) to confirm 
it works, like 9090909090C3. Change one of these bytes to 0A 
(9090900A90C3) and notice that the program crashes.

This will print the "return" value (whatever was in eax at
the time program exited).

Use the byte sequences below to see see how the tool reacts.

This folder (ReadMe, source, and exe) should be downloadable at: 
http://camssite.net/FileShareForum/FileDownload?fileName=WindowsJIT.zip

A youtube video explaining this tool:
https://www.youtube.com/watch?v=DTyS8wIKVbk&list=PLN8jffmrV5nIT23cxmyySh6vhLkIoEOpm&index=9&t=5s
**************************************************************
*Semicolon represents new line*

return (RET)-
C3

no instruction (NOP)-
90

return 1 (MOV eax, 0x01; RET)
B801000000C3

return 12345678 (MOV eax, 0x12345678; RET)
B878563412C3

add 2 and 2 (MOV al, 0x02; ADD al 0x02; RET)
B0020402C3

add 4 and 2 (MOV eax, 0x04; ADD eax, 0x02; RET)
B8040000006683C002C3

subtract 4 and 2 (MOV eax, 0x04; SUB eax, 0x02; RET)
B8040000006683E802C3

3^2 (MOV eax, 0x02, MUL eax, RET)
B80300000066F7E0C3

9/9 (MOV eax, 0x09, DIV eax, RET)
B80900000066F7F0C3

return "data" (MOV eax, "data"; RET)
B864617461C3

add value to self 5 times (mov eax, 1; xor cx, cx; loop:;add eax, eax;add cx, 1;cmp cx, 5;jne loop;ret)
B80100000031C96601C083C10183F90575F5C3

infinite loop (loop:; jmp loop)
EBFE

SelfCode (syscall to spawn JIT.exe, assuming you haven't changed name)
4831ff48f7e765488b5860488b5b18488b5b20488b1b488b1b488b5b204989d88b5b3c4c01c34831c96681c1ff8848c1e9088b140b4c01c24d31d2448b521c4d01c24d31db448b5a204d01c34d31e4448b62244d01c4eb325b594831c04889e251488b0c244831ff418b3c834c01c74889d6f3a6740548ffc0ebe65966418b0444418b04824c01c053c34831c980c10748b80fa89691ba879a9c48f7d048c1e8085051e8b0ffffff4989c64831c95048b8b5b6abd19a879aff48f7d0504889e148ffc24883ec2041ffd65858585858585858FFE0

CalcCode (syscall to run calc.exe)
4831FF48F7E765488B5860488B5B18488B5B20488B1B488B1B488B5B204989D88B5B3C4C01C34831C96681C1FF8848C1E9088B140B4C01C24D31D2448B521C4D01C24D31DB448B5A204D01C34D31E4448B62244D01C4EB325B594831C04889E251488B0C244831FF418B3C834C01C74889D6F3A6740548FFC0EBE65966418B0444418B04824C01C053C34831C980C10748B80FA89691BA879A9C48F7D048C1E8085051E8B0FFFFFF4989C64831C948F7E15048B89C9E939CD19A879A48F7D0504889E148FFC24883EC2041FFD65858585858585858FFE0

NoteCode (WinExec to run notepad.exe)
4883E4F065488B4160488B4018488B702048AD489648AD488B58204D31C0448B433C4C89C24801DA4831C9B1884801D1448B014901D84831F6418B70204801DE4831C949B947657450726F634148FFC14831C08B048E4801D84C390875EF4831F6418B70244801DE668B0C4E4831F6418B701C4801DE4831D28B148E4801DA4889D7B9617279415148B94C6F61644C696272514889E24889D94883EC30FFD74883C4304883C4104889C64831C048B857696E4578656300504889E24889D94883EC28FFD74883C430504831C0B8657865005048B86E6F74657061642E505448C7C201000000488B0C244883EC20FF5424384883C4204883C4185858C3

PaintCode (WinExec to run mspaint.exe)
4883E4F065488B4160488B4018488B702048AD489648AD488B58204D31C0448B433C4C89C24801DA4831C9B1884801D1448B014901D84831F6418B70204801DE4831C949B947657450726F634148FFC14831C08B048E4801D84C390875EF4831F6418B70244801DE668B0C4E4831F6418B701C4801DE4831D28B148E4801DA4889D7B9617279415148B94C6F61644C696272514889E24889D94883EC30FFD74883C4304883C4104889C64831C048B857696E4578656300504889E24889D94883EC28FFD74883C430504831C0B8657865005048B86D737061696E742E505448C7C201000000488B0C244883EC20FF5424384883C4204883C4185858C3

Shellcode (syscall to run cmd.exe)
4831ff48f7e765488b5860488b5b18488b5b20488b1b488b1b488b5b204989d88b5b3c4c01c34831c96681c1ff8848c1e9088b140b4c01c24d31d2448b521c4d01c24d31db448b5a204d01c34d31e4448b62244d01c4eb325b594831c04889e251488b0c244831ff418b3c834c01c74889d6f3a6740548ffc0ebe65966418b0444418b04824c01c053c34831c980c10748b80fa89691ba879a9c48f7d048c1e8085051e8b0ffffff4989c64831c95048b89c929bd19a879aff48f7d0504889e148ffc24883ec2041ffd65858585858585858FFE0

Print "Hello World" (for Strings over 510, must print 510 characters at a time)
Part 1
4883EC284883E4F04831C965488B4160488B4018488B702048AD489648AD488B58204D31C0448B433C4C89C24801DA4831C9B1884801D1448B014901D84831F6418B70204801DE4831C949B947657450726F634148FFC14831C08B048E4801D84C390875EF4831F6418B70244801DE668B0C4E4831F6418B701C4801DE4831D28B148E4801DA4889D7B9617279415148B94C6F61644C696272514889E24889D94883EC30FFD74883C4304883C4104889C64831C066B86C6C5048B86D73766372742E64504889E14883EC30FFD64883C440504831C048B87072696E74660000504889E2488B4C24084883EC30FFD74883C438504831C048B8726C64210A0D00
Part 2
005048B848656C6C6F20776F50544154488B4C24084883EC20FF5424404883C4284883C4185858585858585858FFE0

Create "Hello World" message box (WinAPI call to MessageBoxA)
Part 1
4883EC284883E4F0488D1566000000488D0D52000000E89E0000004C8BF8488D0D5D000000FFD0488D155F000000488D0D4D000000E87F0000004D33C94C8D0561000000488D154E0000004833C9FFD05858585858C39090909090909090E8560000004833C9FFD04B45524E454C33322E444C4C004C6F61644C69627261727941005553455233322E444C4C004D657373616765426F78410048656C6C6F20776F726C64004D657373616765004578697450726F63657373004883EC28654C8B0425600000004D8B40184D8D60104D8B0424FC498B7860488BF1AC84C074268A2780FC617C0380EC203AE0750848FFC748FFC7EBE54D8B004D3BC475D64833
Part 2
C0E9A7000000498B5830448B4B3C4C03CB4981C188000000458B294D85ED75084833C0E9850000004E8D042B458B71044D03F5418B4818458B50204C03D3FFC94D8D0C8A418B394803FB488BF2A675088A0684C07409EBF5E2E64833C0EB4E458B48244C03CB66418B0C49458B481C4C03CB418B0489493BC57C2F493BC6732A488D3418488D7C24304C8BE7A4803E2E75FAA4C707444C4C00498BCC41FFD7498BCC488BD6E914FFFFFF4803C34883C428C3

Get input and print (in development, not working correctly).
Part 1
4883EC284883E4F04831C965488B4160488B4018488B702048AD489648AD488B58204D31C0448B433C4C89C24801DA4831C9B1884801D1448B014901D84831F6418B70204801DE4831C949B947657450726F634148FFC14831C08B048E4801D84C390875EF4831F6418B70244801DE668B0C4E4831F6418B701C4801DE4831D28B148E4801DA4889D7B9617279415148B94C6F61644C696272514889E24889D94883EC30FFD74883C4304883C4104889C64831C066B86C6C5048B86D73766372742E64504889E14883EC30FFD64883C440504831C048B87363616E66000000504889E2488B4C24084883EC30FFD74883C438504831C048B87072696E746600
Part 2
00504889E2488B4C24104883EC28FFD74883C430504831C05048B86E756D6265723A205048B8456E74657220612050544154488B4C24084883EC20FF5424484883C4284883C4204831C066B8256450544154488B4C24084883EC20FF5424404883C4284883C4104831C0B06E5048B8726564202564205C5048B8596F7520656E746550544154488B4C24084883EC20FF5424484883C4284883C420585858585858585858FFE0

Download file from my website and execute (download http://camssite.net/Downloads/ChatClient.exe, execute ChatClient.exe)
Part 1
4883EC284883E4F04831C965488B4160488B4018488B702048AD489648AD488B58204D31C0448B433C4C89C24801DA4831C9B1884801D1448B014901D84831F6418B70204801DE4831C949B947657450726F634148FFC14831C08B048E4801D84C390875EF4831F6418B70244801DE668B0C4E4831F6418B701C4801DE4831D28B148E4801DA4889D7B9617279415148B94C6F61644C696272514889E24889D94883EC30FFD74883C4304883C4104889C64831C066B86C6C5048B875726C6D6F6E2E64504889E14883EC30FFD64883C440504831C066B865415048B86F6164546F46696C5048B855524C446F776E6C504889E2488B4C24184883EC30FFD748
Part 2
83C448504831C048B857696E4578656300504889E24889D94883EC28FFD74883C430504831C0B82E6578655048B86174436C69656E745048B86C6F6164732F43685048B86E65742F446F776E5048B8616D73736974652E5048B8687474703A2F2F6350544831C048B86E742E65786500005048B843686174436C696550544831C0504D31C94C8B442408488B5424204831C94883EC20FF9424800000004883C4204883C4584831C048B86E742E65786500005048B843686174436C6965505448C7C201000000488B0C244883EC20FF5424384883C4204883C4185858585858585858C3


******************************************************************
More Info-

Inqueries and other versions (x86 Linux Port, ARM Linux Port, 
x86 Linux Interpreter based on this) available at:
camerongrande95@gmail.com

To create custom bytes to run, you can use an assembler like NASM.
If further explination needed- download NASM, create .asm file
with your assembly in it (You can start by using just a simple 
instruction, RET). Use from a command line, move nasm.exe and 
your .asm file into the same directory. Then do:
nasm <fileName>.asm -o <fileName>.bin
You can now open <fileName>.bin with a hex editor. This will 
contain your bytes to run. Remove spaces and run.

To compile from source, you may need to compile using Pelles C with Windows
Extensions enabled, or include library with Windows Headers elsewhere.
Pelles C project included for this reason.

For generating shellcode, a good tool can be found here-
https://github.com/NytroRST/ShellcodeCompiler

To use this from other programming languages (Java, Python, etc) you 
must remove the main method and compile the source into a .dll. This
can be done with tcc using the following command-
tcc "<pathToYourFile>\<fileName>.c" -I "<pathToJava\Java\jdk-11.0.9\include" -I "<pathToJava>\Java\jdk-11.0.9\include\win32" -shared -o "<pathToOutputFile>/<fileName>.dll"
You can now load your dll in your language and use native interfacing
to invoke these c functions.

*****************************************************************
